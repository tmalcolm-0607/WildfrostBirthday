# Event Ordering

| Event                                                                                                                                    | Parameter(s)                                   | Invokes                  | Notes                                                                                                              |
|:-----------------------------------------------------------------------------------------------------------------------------------------|:-----------------------------------------------|:-------------------------|:-------------------------------------------------------------------------------------------------------------------|
| Battle.Run                                                                                                                               | nan                                            | nan                      | nan                                                                                                                |
| Events.BattleStart                                                                                                                       | (None)                                         | ???                      | nan                                                                                                                |
| Events.BattleTurnEnd                                                                                                                     | Turn count (int)                               | ???                      | Turn 0?                                                                                                            |
| (Card Drawing)                                                                                                                           | ---                                            | ---                      | Repeated multiple times                                                                                            |
| (Battle Loop)                                                                                                                            | ----                                           | ---                      | Repeated multiple times                                                                                            |
| Events.OnBattleEnd                                                                                                                       | (None)                                         | ???                      | nan                                                                                                                |
| Events.PreBattleEnd                                                                                                                      | (None)                                         | ???                      | Yes, this is after Events.OnBattleEnd                                                                              |
| Events.OnBattlePreRewards                                                                                                                | (None)                                         | ???                      | Only on victory                                                                                                    |
| Events.OnBattleWin                                                                                                                       | (None)                                         | ???                      | nan                                                                                                                |
| nan                                                                                                                                      | nan                                            | nan                      | nan                                                                                                                |
| ActionDraw.Run/ActionDrawHand.Run (Card Drawing)                                                                                         | nan                                            | nan                      | nan                                                                                                                |
| Events.OnCardDraw                                                                                                                        | Amount to draw (int)                           | ???                      | Called before drawing; amount to be drawn                                                                          |
| Events.OnCardDrawEnd*                                                                                                                    | (None)                                         | ???                      | *Called when deck is empty                                                                                         |
| Events.OnCardDraw*                                                                                                                       | Amount to draw (int)                           | ???                      | *Called when deck was empty; updated amount to be drawn                                                            |
| Events.OnEntityMoved                                                                                                                     | Moved card (Entity)                            | ???                      | nan                                                                                                                |
| OnCardMove                                                                                                                               | Moved card (Entity)                            | All active effects       | nan                                                                                                                |
| Events.OnCardDrawEnd                                                                                                                     | (None)                                         | ???                      | nan                                                                                                                |
| nan                                                                                                                                      | nan                                            | nan                      | nan                                                                                                                |
| nan                                                                                                                                      | nan                                            | nan                      | nan                                                                                                                |
| Battle.Loop (Battle Loop)                                                                                                                | nan                                            | nan                      | nan                                                                                                                |
| Events.OnBattlePreTurnStart                                                                                                              | Turn count (int)                               | ???                      | Start of play phase, turn count advances immediately after                                                         |
| Events.OnBattleTurnStart                                                                                                                 | Turn count (int)                               | ???                      | Start of battle phase                                                                                              |
| OnTurnStart                                                                                                                              | Each card in hand (Entity)                     | All active effects       | Called multiple times                                                                                              |
| OnTurn                                                                                                                                   | Each card in hand (Entity)                     | All active effects       | Called multiple times                                                                                              |
| Events.OnPreProcessUnits                                                                                                                 | Enemy (Character)                              | ???                      | nan                                                                                                                |
| OnTurnStart                                                                                                                              | Each active enemy card (Entity)                | All active effects       | Called multiple times                                                                                              |
| Events.OnEntityCountDown                                                                                                                 | Each active enemy card (Entity), amount (int)  | ??? (Snow?, Spice Flag?) | Called multiple times; amount is a ref variable                                                                    |
| (Triggering)                                                                                                                             | ---                                            | ---                      | Triggering is checked in more places than here, but the count downing happens here for enemies                     |
| (Process Hits)                                                                                                                           | ---                                            | ---                      | Probably                                                                                                           |
| OnTurn                                                                                                                                   | Each active enemy card (Entity)                | All active effects       | Called multiple times                                                                                              |
| Events.OnPostProcessUnits                                                                                                                | Enemy (Character)                              | ???                      | nan                                                                                                                |
| Events.OnPreProcessUnits                                                                                                                 | Player (Character)                             | ???                      | nan                                                                                                                |
| OnTurnStart                                                                                                                              | Each active player card (Entity)               | All active effects       | Called multiple times                                                                                              |
| Events.OnEntityCountDown                                                                                                                 | Each active player card (Entity), amount (int) | ??? (Snow?, Spice Flag?) | Called multiple times; amount is a ref variable                                                                    |
| (Triggering)                                                                                                                             | ---                                            | ---                      | Triggering is checked in more places than here, but the count downing happens here for player units                |
| (Process Hits)                                                                                                                           | ---                                            | ---                      | Probably                                                                                                           |
| OnTurn                                                                                                                                   | Each active player card (Entity)               | All active effects       | Called multiple times                                                                                              |
| Events.OnPostProcessUnits                                                                                                                | Player (Character)                             | ???                      | nan                                                                                                                |
| OnTurnEnd                                                                                                                                | Each card in hand and on board (Entity)        | All active effects       | Called multiple times; Enemies -> Friendlies -> Hand                                                               |
| Events.OnBattleTurnEnd                                                                                                                   | Turn count (int)                               | ???                      | nan                                                                                                                |
| nan                                                                                                                                      | nan                                            | nan                      | nan                                                                                                                |
| nan                                                                                                                                      | nan                                            | nan                      | nan                                                                                                                |
| ActionTrigger.Run (Triggering / Playing "Play" Cards)                                                                                    | nan                                            | nan                      | nan                                                                                                                |
| Events.OnPreProcessTrigger                                                                                                               | Triggered card (Entity)                        | ???                      | nan                                                                                                                |
| Events.OnEntityPreTrigger                                                                                                                | Trigger context (Trigger)                      | ???                      | Trigger is a ref variable (so can be replaced entirely), occurs before checking if the trigger is worth triggering |
| PreTrigger                                                                                                                               | Trigger context (Trigger)                      | All active effects       | Trigger is not a ref variable, occurs before checking if the trigger is worth triggering                           |
| Events.OnEntityTrigger                                                                                                                   | Trigger context (Trigger)                      | ???                      | Trigger is a ref variable                                                                                          |
| OnPreCardPlayed                                                                                                                          | Card (Entity), targets (Entity[])              | All active effects       | nan                                                                                                                |
| PreAttack                                                                                                                                | Current hit (Hit)                              | All active effects       | For multiple hits, done in parallel                                                                                |
| (Process Hits)                                                                                                                           | ---                                            | ---                      | For multiple hits, done in parallel.                                                                               |
| PostAttack                                                                                                                               | Current hit (Hit)                              | All active effects       | For multiple hits, done in parallel                                                                                |
| OnCardPlayed                                                                                                                             | Card (Entity), targets (Entity[])              | All active effects       | nan                                                                                                                |
| Events.OnEntityTriggered                                                                                                                 | Tirgger context                                | ???                      | Trigger is a ref variable                                                                                          |
| nan                                                                                                                                      | nan                                            | nan                      | nan                                                                                                                |
| Hit.Process (Process Hits)                                                                                                               | nan                                            | nan                      | nan                                                                                                                |
| OnHit                                                                                                                                    | Current hit (Hit)                              | All active effects       | nan                                                                                                                |
| Events.OnEntityHit                                                                                                                       | Current hit (Hit)                              | ???                      | OnHit for non-StatusEffectData stuff*                                                                              |
| (Dealing damage)                                                                                                                         | ---                                            | ---                      | Just some arithmetic*                                                                                              |
| (Apply)                                                                                                                                  | ---                                            | ---                      | All apply effects resolve in parallel*                                                                             |
| OnEnityPostHit                                                                                                                           | Current hit (Hit)                              | ???                      | nan                                                                                                                |
| PostHit                                                                                                                                  | Current hit (Hit)                              | All active effects       | nan                                                                                                                |
| *Technically these only happen if the hit wasn't dodged (and Events.OnEntityDodged would be invoked), but dodging is an unused mechanic. | nan                                            | nan                      | nan                                                                                                                |
| nan                                                                                                                                      | nan                                            | nan                      | nan                                                                                                                |
| nan                                                                                                                                      | nan                                            | nan                      | nan                                                                                                                |
| StatusEventSystem.Apply (Apply)                                                                                                          | nan                                            | nan                      | nan                                                                                                                |
| OnApplyStatus                                                                                                                            | Application of effect (StatusEffectApply)      | All active effects       | nan                                                                                                                |
| onEffectApplied                                                                                                                          | Application of effect (StatusEffectApply)      | ???                      | onEffectApplied is a parameter passed into Apply                                                                   |
| OnBegin                                                                                                                                  | (None)                                         | Applied effect           | not called if the effect was already present; target is defined                                                    |
| OnStack                                                                                                                                  | Added amount (int)                             | Applied effect           | nan                                                                                                                |
| Events.OnStatusEffectApplied                                                                                                             | Application of effect (StatusEffectApply)      | ???                      | Effectively OnPostStatus                                                                                           |
| OnPostApplyStatus                                                                                                                        | Application of effect (StatusEffectApply)      | All active effects*      | May include the newly applied effect, depending on circumstances                                                   |
| nan                                                                                                                                      | nan                                            | nan                      | nan                                                                                                                |
| Campaign Generation (Campaign.Start)                                                                                                     | nan                                            | nan                      | nan                                                                                                                |
| Load [UI] Scene                                                                                                                          | ---                                            | ---                      | Events.OnSceneLoaded will be invoked by this                                                                       |
| Events.OnCampaignStart                                                                                                                   | ---                                            | ???                      | Invoked before anything occurs                                                                                     |
| (A: if continued run)                                                                                                                    | nan                                            | nan                      | nan                                                                                                                |
| Events.OnCampaignLoaded                                                                                                                  | ---                                            | ???                      | Done twice. The second will be invoked after everything is loaded                                                  |
| (B: if new run)                                                                                                                          | nan                                            | nan                      | nan                                                                                                                |
| Events.CampaignLoadPreset                                                                                                                | Campaign outline (string[])                    | ???                      | The lines are an outline of the paths in the run.The parameter is a ref variable.                                  |
| Events.CampaignNodesCreated                                                                                                              | Nodes (List<Node>), spacing (Vector2)          | ???                      | nodes is a ref variable. Connection between nodes are established already                                          |
| Events.PreCampaignPopulate                                                                                                               | Campaign (Campaign)                            | ???                      | nan                                                                                                                |
| Events.CampaignGenerated                                                                                                                 | ---                                            | ???                      | CampaignStats is created right before the invokation                                                               |
| Events.CampaignSaved                                                                                                                     | ---                                            | ???                      | nan                                                                                                                |
| Adding/Disabling Systems                                                                                                                 | ---                                            | ---                      | nan                                                                                                                |
| Load [MapNew] Scene                                                                                                                      | ---                                            | ---                      | Events.OnSceneLoaded will be invoked by this                                                                       |